{% extends "base.html" %}

{% load staticfiles %}

{% block title %}Pollaboration - {{request.user.first_name}}'s Profile{% endblock title %}

{% block profile %}

<div class="row">
	<div class="col-12 col-lg-7 col-sm-9 pull-center lightgray">
        <h1>{{request.user.name}}</h1>
        <p>Member since {{request.user.created}}<p>
        </div>
        <h2>Info <a href="#" class="pull-right"><i class="icon-pen"></i></a></h2>
        <div class="row">
            <div class="col-6 col-lg-6 col-sm-6">
                <p>
                    Age:&nbsp;&nbsp;&nbsp;&nbsp;{{request.user.age}}<br>
                    <i class="icon-placepin"></i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[LOCATION]<br>
                    <i class="icon-users"></i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{request.user.friends.count}} Friends
                </p>
            </div>
            <div class="col-6 col-lg-6 col-sm-6">
                <p class="pull-right">
                    Social:&nbsp;&nbsp;None<br>
                    Add:&nbsp;&nbsp;
                    <a href="#"><i class="icon-facebook_circle"></i></a>
                    <a href="#"><i class="icon-twitter_circle"></i></a>
                    <a href="#"><i class="icon-google_plus_circle"></i></a>
                </p>
            </div>
        </div>
    	<h2>
            Answers - [# Answered]
            <a href="#" class="pull-right" data-toggle="tooltip" data-placement="left" class="tt" title data-original-title="All the questions you've asked Pollaboration are listed here. Click any question for more detail."><i class="icon-white_question"></i></a>
        </h2>
        <div class="row">
            <div class="col-12 col-lg-12 col-sm-12">
                <div class="pollChart" id="grid"></div>
            </div>
        </div>
    	   
    	<h2>
            Questions - [# Asked]
            <a href="#" class="pull-right" data-toggle="tooltip" data-placement="left" title data-original-title="All the questions you've asked Pollaboration are listed here. Click any question for more detail."><i class="icon-white_question"></i>
        </h2>
        <div class="row">
            <div class="col-8 col-lg-8 col-sm-8 pull-center">
            	{% for submission in request.user.submissions.all %}
            	<div class="pollChart" id="stacked{{forloop.counter}}"></div>
            	{%endfor%}
            </div>
        </div>
    </div>
</div>
{% endblock profile %}

{% block extra_js %}
<script src="{% static 'js/vendor/d3.js' %}"></script>
<script src="{% static 'js/vendor/underscore.js' %}"></script>
<script src="{% static 'js/chart.js' %}"></script>
<script>
    $(function () {
        $(".tt").tooltip();
    });
</script>
<script>
{% for submission in request.user.submissions.all %}
var stackeddata{{forloop.counter}} = [
{% for a in submission.answers.all %}
{
    id: {{forloop.counter}},
    label: "{{a.answer}}",
    value: {{a.votes.count}}
}{% if not foorloop.last %},{%endif%}{%endfor%}
];
        pollChart.stacked({
            el: "#stacked{{forloop.counter}}",
            data: stackeddata{{forloop.counter}} ,
            /*width: 700,*/
            height: 60,
            margin: {
                top: 0,
                right: 0,
                bottom: 30,
                left: 0
            },
            colors: ["#FFF5E4", "#FF7E65", "#7DCDFC", "#2084C4", "#3D444B"]
        });
{%endfor%}
</script>
<script>
pollChart.grid({
            el: "#grid",
            /*width: 700,
            height: 60,*/
            margin: {
                top: 0,
                right: 0,
                bottom: 0,
                left: 0
            },
            colors: ["#FFF5E4", "#FF7E65", "#7DCDFC", "#2084C4", "#3D444B"],
            data: [
    {% for x in grid_data %}
    {
        question:"{{x.question|safe}}",
        answers:[
            {% for y in x.answers %}
                {
                    id:{{y.id}},
                    label:"{{y.label|safe}}",
                    value:{{y.value}}
                }{%if not forloop.last %},{%endif%}
                {%endfor%}
                ],
        chosen:{{x.chosen}}
    }{% if not foorloop.last %},{%endif%}
    {% endfor %}
    ]
        });
</script>
{% endblock extra_js %}